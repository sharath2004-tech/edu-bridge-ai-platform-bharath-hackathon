{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/auth.ts"],"sourcesContent":["import { cookies } from 'next/headers';\n\nexport type Session = { id: string; role: 'student'|'teacher'|'admin'; name: string; email: string }\n\nexport async function getSession(): Promise<Session | null> {\n  const cookieStore = await cookies()\n  const c = cookieStore.get('edubridge_session')?.value\n  if (!c) return null\n  try {\n    return JSON.parse(c)\n  } catch {\n    return null\n  }\n}\n\nexport async function requireRole(role: Session['role']): Promise<Session | null> {\n  const s = await getSession()\n  if (!s || s.role !== role) {\n    return null\n  }\n  return s\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAIO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,2QAAO;IACjC,MAAM,IAAI,YAAY,GAAG,CAAC,sBAAsB;IAChD,IAAI,CAAC,GAAG,OAAO;IACf,IAAI;QACF,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe,YAAY,IAAqB;IACrD,MAAM,IAAI,MAAM;IAChB,IAAI,CAAC,KAAK,EAAE,IAAI,KAAK,MAAM;QACzB,OAAO;IACT;IACA,OAAO;AACT"}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/School.ts"],"sourcesContent":["import mongoose, { Document, Model, Schema } from 'mongoose';\n\nexport interface ISchool extends Document {\n  _id: string;\n  name: string;\n  code: string; // Unique school code for registration\n  email: string;\n  phone?: string;\n  address: {\n    street?: string;\n    city: string;\n    state: string;\n    country: string;\n    zipCode?: string;\n  };\n  principal?: {\n    name: string;\n    email: string;\n    phone?: string;\n  };\n  logo?: string;\n  website?: string;\n  established?: Date;\n  type: 'primary' | 'secondary' | 'higher-secondary' | 'university' | 'institute';\n  board?: string; // CBSE, ICSE, State Board, etc.\n  isActive: boolean;\n  subscription?: {\n    plan: 'free' | 'basic' | 'premium' | 'enterprise';\n    startDate: Date;\n    endDate?: Date;\n    maxStudents?: number;\n    maxTeachers?: number;\n  };\n  stats?: {\n    totalStudents: number;\n    totalTeachers: number;\n    totalCourses: number;\n  };\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst SchoolSchema = new Schema<ISchool>(\n  {\n    name: {\n      type: String,\n      required: [true, 'School name is required'],\n      trim: true,\n      maxlength: [200, 'School name cannot exceed 200 characters'],\n    },\n    code: {\n      type: String,\n      required: [true, 'School code is required'],\n      unique: true,\n      uppercase: true,\n      trim: true,\n      match: [/^[A-Z0-9]{4,10}$/, 'School code must be 4-10 alphanumeric characters'],\n    },\n    email: {\n      type: String,\n      required: [true, 'School email is required'],\n      unique: true,\n      lowercase: true,\n      trim: true,\n      match: [\n        /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/,\n        'Please provide a valid email',\n      ],\n    },\n    phone: {\n      type: String,\n      trim: true,\n    },\n    address: {\n      street: String,\n      city: {\n        type: String,\n        required: [true, 'City is required'],\n      },\n      state: {\n        type: String,\n        required: [true, 'State is required'],\n      },\n      country: {\n        type: String,\n        required: [true, 'Country is required'],\n        default: 'India',\n      },\n      zipCode: String,\n    },\n    principal: {\n      name: String,\n      email: String,\n      phone: String,\n    },\n    logo: {\n      type: String,\n      default: '',\n    },\n    website: {\n      type: String,\n      trim: true,\n    },\n    established: {\n      type: Date,\n    },\n    type: {\n      type: String,\n      enum: ['primary', 'secondary', 'higher-secondary', 'university', 'institute'],\n      default: 'secondary',\n      required: true,\n    },\n    board: {\n      type: String,\n      default: 'CBSE',\n    },\n    isActive: {\n      type: Boolean,\n      default: true,\n    },\n    subscription: {\n      plan: {\n        type: String,\n        enum: ['free', 'basic', 'premium', 'enterprise'],\n        default: 'free',\n      },\n      startDate: {\n        type: Date,\n        default: Date.now,\n      },\n      endDate: Date,\n      maxStudents: {\n        type: Number,\n        default: 100,\n      },\n      maxTeachers: {\n        type: Number,\n        default: 10,\n      },\n    },\n    stats: {\n      totalStudents: {\n        type: Number,\n        default: 0,\n      },\n      totalTeachers: {\n        type: Number,\n        default: 0,\n      },\n      totalCourses: {\n        type: Number,\n        default: 0,\n      },\n    },\n  },\n  {\n    timestamps: true,\n  }\n);\n\n// Indexes for better query performance\n// Note: code and email already have indexes from schema definitions\nSchoolSchema.index({ isActive: 1 });\nSchoolSchema.index({ 'subscription.plan': 1 });\n\nconst School: Model<ISchool> =\n  mongoose.models.School || mongoose.model<ISchool>('School', SchoolSchema);\n\nexport default School;\n"],"names":[],"mappings":";;;;AAAA;;AA0CA,MAAM,eAAe,IAAI,mHAAM,CAC7B;IACE,MAAM;QACJ,MAAM;QACN,UAAU;YAAC;YAAM;SAA0B;QAC3C,MAAM;QACN,WAAW;YAAC;YAAK;SAA2C;IAC9D;IACA,MAAM;QACJ,MAAM;QACN,UAAU;YAAC;YAAM;SAA0B;QAC3C,QAAQ;QACR,WAAW;QACX,MAAM;QACN,OAAO;YAAC;YAAoB;SAAmD;IACjF;IACA,OAAO;QACL,MAAM;QACN,UAAU;YAAC;YAAM;SAA2B;QAC5C,QAAQ;QACR,WAAW;QACX,MAAM;QACN,OAAO;YACL;YACA;SACD;IACH;IACA,OAAO;QACL,MAAM;QACN,MAAM;IACR;IACA,SAAS;QACP,QAAQ;QACR,MAAM;YACJ,MAAM;YACN,UAAU;gBAAC;gBAAM;aAAmB;QACtC;QACA,OAAO;YACL,MAAM;YACN,UAAU;gBAAC;gBAAM;aAAoB;QACvC;QACA,SAAS;YACP,MAAM;YACN,UAAU;gBAAC;gBAAM;aAAsB;YACvC,SAAS;QACX;QACA,SAAS;IACX;IACA,WAAW;QACT,MAAM;QACN,OAAO;QACP,OAAO;IACT;IACA,MAAM;QACJ,MAAM;QACN,SAAS;IACX;IACA,SAAS;QACP,MAAM;QACN,MAAM;IACR;IACA,aAAa;QACX,MAAM;IACR;IACA,MAAM;QACJ,MAAM;QACN,MAAM;YAAC;YAAW;YAAa;YAAoB;YAAc;SAAY;QAC7E,SAAS;QACT,UAAU;IACZ;IACA,OAAO;QACL,MAAM;QACN,SAAS;IACX;IACA,UAAU;QACR,MAAM;QACN,SAAS;IACX;IACA,cAAc;QACZ,MAAM;YACJ,MAAM;YACN,MAAM;gBAAC;gBAAQ;gBAAS;gBAAW;aAAa;YAChD,SAAS;QACX;QACA,WAAW;YACT,MAAM;YACN,SAAS,KAAK,GAAG;QACnB;QACA,SAAS;QACT,aAAa;YACX,MAAM;YACN,SAAS;QACX;QACA,aAAa;YACX,MAAM;YACN,SAAS;QACX;IACF;IACA,OAAO;QACL,eAAe;YACb,MAAM;YACN,SAAS;QACX;QACA,eAAe;YACb,MAAM;YACN,SAAS;QACX;QACA,cAAc;YACZ,MAAM;YACN,SAAS;QACX;IACF;AACF,GACA;IACE,YAAY;AACd;AAGF,uCAAuC;AACvC,oEAAoE;AACpE,aAAa,KAAK,CAAC;IAAE,UAAU;AAAE;AACjC,aAAa,KAAK,CAAC;IAAE,qBAAqB;AAAE;AAE5C,MAAM,SACJ,oHAAQ,CAAC,MAAM,CAAC,MAAM,IAAI,oHAAQ,CAAC,KAAK,CAAU,UAAU;uCAE/C"}},
    {"offset": {"line": 250, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/User.ts"],"sourcesContent":["import mongoose, { Document, Model, Schema } from 'mongoose';\n\nexport interface IUser extends Document {\n  _id: string;\n  name: string;\n  email: string;\n  password: string;\n  role: 'super-admin' | 'principal' | 'teacher' | 'student';\n  schoolId?: mongoose.Types.ObjectId;\n  avatar?: string;\n  bio?: string;\n  phone?: string;\n  isActive: boolean;\n  // Teacher-specific fields\n  subjectSpecialization?: string;\n  teacherRole?: 'Teacher' | 'HOD' | 'Vice Principal';\n  assignedClasses?: mongoose.Types.ObjectId[]; // Array of Class IDs\n  assignedSubjects?: mongoose.Types.ObjectId[]; // Array of Subject IDs\n  // Student-specific fields\n  classId?: mongoose.Types.ObjectId; // Reference to Class model\n  rollNo?: number;\n  parentName?: string;\n  parentPhone?: string;\n  // Legacy fields (for backward compatibility)\n  className?: string; // e.g., '10-A'\n  section?: string; // e.g., 'A', 'B', 'C', 'D', 'E'\n  rollNumber?: string;\n  enrolledCourses?: mongoose.Types.ObjectId[];\n  // Teacher fields\n  createdCourses?: mongoose.Types.ObjectId[];\n  progress?: {\n    courseId: mongoose.Types.ObjectId;\n    completedLessons: number;\n    totalLessons: number;\n    lastAccessed: Date;\n  }[];\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst UserSchema = new Schema<IUser>(\n  {\n    name: {\n      type: String,\n      required: [true, 'Please provide a name'],\n      trim: true,\n      maxlength: [100, 'Name cannot be more than 100 characters'],\n    },\n    email: {\n      type: String,\n      required: [true, 'Please provide an email'],\n      unique: true,\n      lowercase: true,\n      trim: true,\n      match: [\n        /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/,\n        'Please provide a valid email',\n      ],\n    },\n    password: {\n      type: String,\n      required: [true, 'Please provide a password'],\n      minlength: [6, 'Password must be at least 6 characters'],\n      select: false, // Don't return password by default\n    },\n    role: {\n      type: String,\n      enum: ['super-admin', 'principal', 'teacher', 'student'],\n      default: 'student',\n      required: true,\n    },\n    schoolId: {\n      type: Schema.Types.ObjectId,\n      ref: 'School',\n    },\n    avatar: {\n      type: String,\n      default: '',\n    },\n    bio: {\n      type: String,\n      maxlength: [500, 'Bio cannot be more than 500 characters'],\n    },\n    phone: {\n      type: String,\n      trim: true,\n    },\n    isActive: {\n      type: Boolean,\n      default: true,\n    },\n    // Teacher-specific fields\n    subjectSpecialization: {\n      type: String,\n      trim: true,\n    },\n    teacherRole: {\n      type: String,\n      enum: ['Teacher', 'HOD', 'Vice Principal'],\n    },\n    assignedClasses: [\n      {\n        type: Schema.Types.ObjectId,\n        ref: 'Class',\n      },\n    ],\n    assignedSubjects: [\n      {\n        type: Schema.Types.ObjectId,\n        ref: 'Subject',\n      },\n    ],\n    // Student-specific fields\n    classId: {\n      type: Schema.Types.ObjectId,\n      ref: 'Class',\n      index: true,\n    },\n    rollNo: {\n      type: Number,\n      min: 1,\n    },\n    parentName: {\n      type: String,\n      trim: true,\n    },\n    parentPhone: {\n      type: String,\n      trim: true,\n    },\n    // Legacy fields (backward compatibility)\n    className: {\n      type: String,\n      trim: true,\n    },\n    section: {\n      type: String,\n      trim: true,\n    },\n    rollNumber: {\n      type: String,\n      trim: true,\n    },\n    enrolledCourses: [\n      {\n        type: Schema.Types.ObjectId,\n        ref: 'Course',\n      },\n    ],\n    createdCourses: [\n      {\n        type: Schema.Types.ObjectId,\n        ref: 'Course',\n      },\n    ],\n    progress: [\n      {\n        courseId: {\n          type: Schema.Types.ObjectId,\n          ref: 'Course',\n        },\n        completedLessons: {\n          type: Number,\n          default: 0,\n        },\n        totalLessons: {\n          type: Number,\n          default: 0,\n        },\n        lastAccessed: {\n          type: Date,\n          default: Date.now,\n        },\n      },\n    ],\n  },\n  {\n    timestamps: true,\n  }\n);\n\n// Indexes for better query performance\nUserSchema.index({ role: 1 });\nUserSchema.index({ schoolId: 1, role: 1 });\n// email already has unique index from schema definition\n\nconst User: Model<IUser> =\n  mongoose.models.User || mongoose.model<IUser>('User', UserSchema);\n\nexport default User;\n"],"names":[],"mappings":";;;;AAAA;;AAwCA,MAAM,aAAa,IAAI,mHAAM,CAC3B;IACE,MAAM;QACJ,MAAM;QACN,UAAU;YAAC;YAAM;SAAwB;QACzC,MAAM;QACN,WAAW;YAAC;YAAK;SAA0C;IAC7D;IACA,OAAO;QACL,MAAM;QACN,UAAU;YAAC;YAAM;SAA0B;QAC3C,QAAQ;QACR,WAAW;QACX,MAAM;QACN,OAAO;YACL;YACA;SACD;IACH;IACA,UAAU;QACR,MAAM;QACN,UAAU;YAAC;YAAM;SAA4B;QAC7C,WAAW;YAAC;YAAG;SAAyC;QACxD,QAAQ;IACV;IACA,MAAM;QACJ,MAAM;QACN,MAAM;YAAC;YAAe;YAAa;YAAW;SAAU;QACxD,SAAS;QACT,UAAU;IACZ;IACA,UAAU;QACR,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;IACP;IACA,QAAQ;QACN,MAAM;QACN,SAAS;IACX;IACA,KAAK;QACH,MAAM;QACN,WAAW;YAAC;YAAK;SAAyC;IAC5D;IACA,OAAO;QACL,MAAM;QACN,MAAM;IACR;IACA,UAAU;QACR,MAAM;QACN,SAAS;IACX;IACA,0BAA0B;IAC1B,uBAAuB;QACrB,MAAM;QACN,MAAM;IACR;IACA,aAAa;QACX,MAAM;QACN,MAAM;YAAC;YAAW;YAAO;SAAiB;IAC5C;IACA,iBAAiB;QACf;YACE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;YAC3B,KAAK;QACP;KACD;IACD,kBAAkB;QAChB;YACE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;YAC3B,KAAK;QACP;KACD;IACD,0BAA0B;IAC1B,SAAS;QACP,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,OAAO;IACT;IACA,QAAQ;QACN,MAAM;QACN,KAAK;IACP;IACA,YAAY;QACV,MAAM;QACN,MAAM;IACR;IACA,aAAa;QACX,MAAM;QACN,MAAM;IACR;IACA,yCAAyC;IACzC,WAAW;QACT,MAAM;QACN,MAAM;IACR;IACA,SAAS;QACP,MAAM;QACN,MAAM;IACR;IACA,YAAY;QACV,MAAM;QACN,MAAM;IACR;IACA,iBAAiB;QACf;YACE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;YAC3B,KAAK;QACP;KACD;IACD,gBAAgB;QACd;YACE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;YAC3B,KAAK;QACP;KACD;IACD,UAAU;QACR;YACE,UAAU;gBACR,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;gBAC3B,KAAK;YACP;YACA,kBAAkB;gBAChB,MAAM;gBACN,SAAS;YACX;YACA,cAAc;gBACZ,MAAM;gBACN,SAAS;YACX;YACA,cAAc;gBACZ,MAAM;gBACN,SAAS,KAAK,GAAG;YACnB;QACF;KACD;AACH,GACA;IACE,YAAY;AACd;AAGF,uCAAuC;AACvC,WAAW,KAAK,CAAC;IAAE,MAAM;AAAE;AAC3B,WAAW,KAAK,CAAC;IAAE,UAAU;IAAG,MAAM;AAAE;AACxC,wDAAwD;AAExD,MAAM,OACJ,oHAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,oHAAQ,CAAC,KAAK,CAAQ,QAAQ;uCAEzC"}},
    {"offset": {"line": 435, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/Class.ts"],"sourcesContent":["import mongoose, { Document, Schema } from 'mongoose';\n\nexport interface IClass extends Document {\n  _id: string;\n  schoolId: mongoose.Types.ObjectId;\n  className: string; // e.g., \"LKG\", \"1st\", \"2nd\", \"10th\"\n  section: string; // e.g., \"A\", \"B\", \"C\"\n  classTeacherId?: mongoose.Types.ObjectId;\n  academicYear?: string; // e.g., \"2024-2025\"\n  strength?: number; // Total students in this class\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst ClassSchema = new Schema<IClass>(\n  {\n    schoolId: {\n      type: Schema.Types.ObjectId,\n      ref: 'School',\n      required: [true, 'School ID is required'],\n      index: true,\n    },\n    className: {\n      type: String,\n      required: [true, 'Class name is required'],\n      trim: true,\n      // LKG, UKG, 1st, 2nd, 3rd, 4th, 5th, 6th, 7th, 8th, 9th, 10th, 11th, 12th\n    },\n    section: {\n      type: String,\n      required: [true, 'Section is required'],\n      trim: true,\n      uppercase: true,\n      // A, B, C, D, E, etc.\n    },\n    classTeacherId: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n      index: true,\n    },\n    academicYear: {\n      type: String,\n      trim: true,\n    },\n    strength: {\n      type: Number,\n      default: 0,\n      min: 0,\n    },\n  },\n  {\n    timestamps: true,\n  }\n);\n\n// Compound index to ensure unique class-section per school\nClassSchema.index({ schoolId: 1, className: 1, section: 1 }, { unique: true });\n\n// Index for querying by class teacher\nClassSchema.index({ classTeacherId: 1 });\n\nconst Class = mongoose.models.Class || mongoose.model<IClass>('Class', ClassSchema);\n\nexport default Class;\n"],"names":[],"mappings":";;;;AAAA;;AAcA,MAAM,cAAc,IAAI,mHAAM,CAC5B;IACE,UAAU;QACR,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,UAAU;YAAC;YAAM;SAAwB;QACzC,OAAO;IACT;IACA,WAAW;QACT,MAAM;QACN,UAAU;YAAC;YAAM;SAAyB;QAC1C,MAAM;IAER;IACA,SAAS;QACP,MAAM;QACN,UAAU;YAAC;YAAM;SAAsB;QACvC,MAAM;QACN,WAAW;IAEb;IACA,gBAAgB;QACd,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,OAAO;IACT;IACA,cAAc;QACZ,MAAM;QACN,MAAM;IACR;IACA,UAAU;QACR,MAAM;QACN,SAAS;QACT,KAAK;IACP;AACF,GACA;IACE,YAAY;AACd;AAGF,2DAA2D;AAC3D,YAAY,KAAK,CAAC;IAAE,UAAU;IAAG,WAAW;IAAG,SAAS;AAAE,GAAG;IAAE,QAAQ;AAAK;AAE5E,sCAAsC;AACtC,YAAY,KAAK,CAAC;IAAE,gBAAgB;AAAE;AAEtC,MAAM,QAAQ,oHAAQ,CAAC,MAAM,CAAC,KAAK,IAAI,oHAAQ,CAAC,KAAK,CAAS,SAAS;uCAExD"}},
    {"offset": {"line": 503, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/Subject.ts"],"sourcesContent":["import mongoose, { Document, Schema } from 'mongoose';\n\nexport interface ISubject extends Document {\n  _id: string;\n  schoolId: mongoose.Types.ObjectId;\n  classId: mongoose.Types.ObjectId;\n  subjectName: string;\n  subjectCode?: string; // Optional subject code like \"MAT101\"\n  teacherId?: mongoose.Types.ObjectId;\n  description?: string;\n  totalLessons?: number;\n  isActive: boolean;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst SubjectSchema = new Schema<ISubject>(\n  {\n    schoolId: {\n      type: Schema.Types.ObjectId,\n      ref: 'School',\n      required: [true, 'School ID is required'],\n      index: true,\n    },\n    classId: {\n      type: Schema.Types.ObjectId,\n      ref: 'Class',\n      required: [true, 'Class ID is required'],\n      index: true,\n    },\n    subjectName: {\n      type: String,\n      required: [true, 'Subject name is required'],\n      trim: true,\n    },\n    subjectCode: {\n      type: String,\n      trim: true,\n      uppercase: true,\n    },\n    teacherId: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n      index: true,\n    },\n    description: {\n      type: String,\n      trim: true,\n      maxlength: 500,\n    },\n    totalLessons: {\n      type: Number,\n      min: 0,\n    },\n    isActive: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  {\n    timestamps: true,\n  }\n);\n\n// Compound index to ensure unique subject per class in a school\nSubjectSchema.index({ schoolId: 1, classId: 1, subjectName: 1 }, { unique: true });\n\n// Index for querying by teacher\nSubjectSchema.index({ teacherId: 1 });\n\nconst Subject = mongoose.models.Subject || mongoose.model<ISubject>('Subject', SubjectSchema);\n\nexport default Subject;\n"],"names":[],"mappings":";;;;AAAA;;AAgBA,MAAM,gBAAgB,IAAI,mHAAM,CAC9B;IACE,UAAU;QACR,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,UAAU;YAAC;YAAM;SAAwB;QACzC,OAAO;IACT;IACA,SAAS;QACP,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,UAAU;YAAC;YAAM;SAAuB;QACxC,OAAO;IACT;IACA,aAAa;QACX,MAAM;QACN,UAAU;YAAC;YAAM;SAA2B;QAC5C,MAAM;IACR;IACA,aAAa;QACX,MAAM;QACN,MAAM;QACN,WAAW;IACb;IACA,WAAW;QACT,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,OAAO;IACT;IACA,aAAa;QACX,MAAM;QACN,MAAM;QACN,WAAW;IACb;IACA,cAAc;QACZ,MAAM;QACN,KAAK;IACP;IACA,UAAU;QACR,MAAM;QACN,SAAS;IACX;AACF,GACA;IACE,YAAY;AACd;AAGF,gEAAgE;AAChE,cAAc,KAAK,CAAC;IAAE,UAAU;IAAG,SAAS;IAAG,aAAa;AAAE,GAAG;IAAE,QAAQ;AAAK;AAEhF,gCAAgC;AAChC,cAAc,KAAK,CAAC;IAAE,WAAW;AAAE;AAEnC,MAAM,UAAU,oHAAQ,CAAC,MAAM,CAAC,OAAO,IAAI,oHAAQ,CAAC,KAAK,CAAW,WAAW;uCAEhE"}},
    {"offset": {"line": 580, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/Attendance.ts"],"sourcesContent":["import mongoose, { Document, Schema } from 'mongoose';\n\nexport interface IAttendance extends Document {\n  studentId: mongoose.Types.ObjectId;\n  schoolId: mongoose.Types.ObjectId;\n  classId?: mongoose.Types.ObjectId;\n  date: Date;\n  status: 'Present' | 'Absent' | 'Late';\n  markedBy?: mongoose.Types.ObjectId; // Teacher or Principal who marked attendance\n  notes?: string;\n  // Legacy fields (backward compatibility)\n  className?: string;\n  section?: string;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst AttendanceSchema = new Schema<IAttendance>(\n  {\n    studentId: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n      required: [true, 'Student ID is required'],\n      index: true,\n    },\n    schoolId: {\n      type: Schema.Types.ObjectId,\n      ref: 'School',\n      required: [true, 'School ID is required'],\n      index: true,\n    },\n    classId: {\n      type: Schema.Types.ObjectId,\n      ref: 'Class',\n      index: true,\n    },\n    className: {\n      type: String,\n      trim: true,\n      index: true,\n    },\n    section: {\n      type: String,\n      trim: true,\n    },\n    date: {\n      type: Date,\n      required: [true, 'Date is required'],\n      index: true,\n    },\n    status: {\n      type: String,\n      enum: ['Present', 'Absent', 'Late', 'present', 'absent', 'late', 'excused'],\n      required: [true, 'Status is required'],\n      default: 'Present',\n    },\n    markedBy: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n    },\n    notes: {\n      type: String,\n      trim: true,\n      maxlength: 500,\n    },\n  },\n  {\n    timestamps: true,\n  }\n);\n\n// Compound indexes for efficient queries\nAttendanceSchema.index({ schoolId: 1, date: -1 });\nAttendanceSchema.index({ studentId: 1, date: -1 });\nAttendanceSchema.index({ schoolId: 1, className: 1, date: -1 });\n\n// Ensure one attendance record per student per day\nAttendanceSchema.index({ studentId: 1, date: 1 }, { unique: true });\n\nexport default mongoose.models.Attendance || mongoose.model<IAttendance>('Attendance', AttendanceSchema);\n"],"names":[],"mappings":";;;;AAAA;;AAiBA,MAAM,mBAAmB,IAAI,mHAAM,CACjC;IACE,WAAW;QACT,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,UAAU;YAAC;YAAM;SAAyB;QAC1C,OAAO;IACT;IACA,UAAU;QACR,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,UAAU;YAAC;YAAM;SAAwB;QACzC,OAAO;IACT;IACA,SAAS;QACP,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,OAAO;IACT;IACA,WAAW;QACT,MAAM;QACN,MAAM;QACN,OAAO;IACT;IACA,SAAS;QACP,MAAM;QACN,MAAM;IACR;IACA,MAAM;QACJ,MAAM;QACN,UAAU;YAAC;YAAM;SAAmB;QACpC,OAAO;IACT;IACA,QAAQ;QACN,MAAM;QACN,MAAM;YAAC;YAAW;YAAU;YAAQ;YAAW;YAAU;YAAQ;SAAU;QAC3E,UAAU;YAAC;YAAM;SAAqB;QACtC,SAAS;IACX;IACA,UAAU;QACR,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;IACP;IACA,OAAO;QACL,MAAM;QACN,MAAM;QACN,WAAW;IACb;AACF,GACA;IACE,YAAY;AACd;AAGF,yCAAyC;AACzC,iBAAiB,KAAK,CAAC;IAAE,UAAU;IAAG,MAAM,CAAC;AAAE;AAC/C,iBAAiB,KAAK,CAAC;IAAE,WAAW;IAAG,MAAM,CAAC;AAAE;AAChD,iBAAiB,KAAK,CAAC;IAAE,UAAU;IAAG,WAAW;IAAG,MAAM,CAAC;AAAE;AAE7D,mDAAmD;AACnD,iBAAiB,KAAK,CAAC;IAAE,WAAW;IAAG,MAAM;AAAE,GAAG;IAAE,QAAQ;AAAK;uCAElD,oHAAQ,CAAC,MAAM,CAAC,UAAU,IAAI,oHAAQ,CAAC,KAAK,CAAc,cAAc"}},
    {"offset": {"line": 682, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/Exam.ts"],"sourcesContent":["import mongoose, { Document, Schema } from 'mongoose';\n\nexport interface IExam extends Document {\n  _id: string;\n  schoolId: mongoose.Types.ObjectId;\n  classId: mongoose.Types.ObjectId;\n  examName: string;\n  examType: 'unit-test' | 'mid-term' | 'final' | 'quarterly' | 'half-yearly' | 'annual' | 'other';\n  date: Date;\n  term?: string; // e.g., \"Term 1\", \"Term 2\"\n  academicYear?: string;\n  totalMarks?: number;\n  duration?: number; // in minutes\n  subjects?: mongoose.Types.ObjectId[]; // Array of subject IDs\n  instructions?: string;\n  isActive: boolean;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst ExamSchema = new Schema<IExam>(\n  {\n    schoolId: {\n      type: Schema.Types.ObjectId,\n      ref: 'School',\n      required: [true, 'School ID is required'],\n      index: true,\n    },\n    classId: {\n      type: Schema.Types.ObjectId,\n      ref: 'Class',\n      required: [true, 'Class ID is required'],\n      index: true,\n    },\n    examName: {\n      type: String,\n      required: [true, 'Exam name is required'],\n      trim: true,\n    },\n    examType: {\n      type: String,\n      enum: ['unit-test', 'mid-term', 'final', 'quarterly', 'half-yearly', 'annual', 'other'],\n      default: 'unit-test',\n    },\n    date: {\n      type: Date,\n      required: [true, 'Exam date is required'],\n      index: true,\n    },\n    term: {\n      type: String,\n      trim: true,\n    },\n    academicYear: {\n      type: String,\n      trim: true,\n    },\n    totalMarks: {\n      type: Number,\n      min: 0,\n    },\n    duration: {\n      type: Number,\n      min: 0,\n    },\n    subjects: [{\n      type: Schema.Types.ObjectId,\n      ref: 'Subject',\n    }],\n    instructions: {\n      type: String,\n      trim: true,\n      maxlength: 1000,\n    },\n    isActive: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  {\n    timestamps: true,\n  }\n);\n\n// Index for querying exams by school and class\nExamSchema.index({ schoolId: 1, classId: 1, date: -1 });\n\n// Index for querying by date\nExamSchema.index({ date: 1 });\n\nconst Exam = mongoose.models.Exam || mongoose.model<IExam>('Exam', ExamSchema);\n\nexport default Exam;\n"],"names":[],"mappings":";;;;AAAA;;AAoBA,MAAM,aAAa,IAAI,mHAAM,CAC3B;IACE,UAAU;QACR,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,UAAU;YAAC;YAAM;SAAwB;QACzC,OAAO;IACT;IACA,SAAS;QACP,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,UAAU;YAAC;YAAM;SAAuB;QACxC,OAAO;IACT;IACA,UAAU;QACR,MAAM;QACN,UAAU;YAAC;YAAM;SAAwB;QACzC,MAAM;IACR;IACA,UAAU;QACR,MAAM;QACN,MAAM;YAAC;YAAa;YAAY;YAAS;YAAa;YAAe;YAAU;SAAQ;QACvF,SAAS;IACX;IACA,MAAM;QACJ,MAAM;QACN,UAAU;YAAC;YAAM;SAAwB;QACzC,OAAO;IACT;IACA,MAAM;QACJ,MAAM;QACN,MAAM;IACR;IACA,cAAc;QACZ,MAAM;QACN,MAAM;IACR;IACA,YAAY;QACV,MAAM;QACN,KAAK;IACP;IACA,UAAU;QACR,MAAM;QACN,KAAK;IACP;IACA,UAAU;QAAC;YACT,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;YAC3B,KAAK;QACP;KAAE;IACF,cAAc;QACZ,MAAM;QACN,MAAM;QACN,WAAW;IACb;IACA,UAAU;QACR,MAAM;QACN,SAAS;IACX;AACF,GACA;IACE,YAAY;AACd;AAGF,+CAA+C;AAC/C,WAAW,KAAK,CAAC;IAAE,UAAU;IAAG,SAAS;IAAG,MAAM,CAAC;AAAE;AAErD,6BAA6B;AAC7B,WAAW,KAAK,CAAC;IAAE,MAAM;AAAE;AAE3B,MAAM,OAAO,oHAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,oHAAQ,CAAC,KAAK,CAAQ,QAAQ;uCAEpD"}},
    {"offset": {"line": 786, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/Mark.ts"],"sourcesContent":["import mongoose, { Document, Schema } from 'mongoose';\n\nexport interface IMark extends Document {\n  studentId: mongoose.Types.ObjectId;\n  schoolId: mongoose.Types.ObjectId;\n  examId: mongoose.Types.ObjectId;\n  subjectId: mongoose.Types.ObjectId;\n  marksScored: number;\n  totalMarks?: number;\n  percentage?: number;\n  grade?: string;\n  remarks?: string;\n  markedBy?: mongoose.Types.ObjectId; // Teacher who entered marks\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst MarkSchema = new Schema<IMark>(\n  {\n    studentId: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n      required: [true, 'Student ID is required'],\n      index: true,\n    },\n    schoolId: {\n      type: Schema.Types.ObjectId,\n      ref: 'School',\n      required: [true, 'School ID is required'],\n      index: true,\n    },\n    examId: {\n      type: Schema.Types.ObjectId,\n      ref: 'Exam',\n      required: [true, 'Exam ID is required'],\n      index: true,\n    },\n    subjectId: {\n      type: Schema.Types.ObjectId,\n      ref: 'Subject',\n      required: [true, 'Subject ID is required'],\n      index: true,\n    },\n    marksScored: {\n      type: Number,\n      required: [true, 'Marks scored is required'],\n      min: 0,\n    },\n    totalMarks: {\n      type: Number,\n      min: 1,\n    },\n    percentage: {\n      type: Number,\n      min: 0,\n      max: 100,\n    },\n    grade: {\n      type: String,\n      trim: true,\n    },\n    remarks: {\n      type: String,\n      trim: true,\n      maxlength: 500,\n    },\n    markedBy: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n    },\n  },\n  {\n    timestamps: true,\n  }\n);\n\n// Compound indexes for efficient queries\nMarkSchema.index({ schoolId: 1, examId: 1 });\nMarkSchema.index({ studentId: 1, examId: 1, subjectId: 1 }, { unique: true });\nMarkSchema.index({ examId: 1, subjectId: 1 });\n\n// Pre-save hook to calculate percentage and grade\nMarkSchema.pre('save', function () {\n  if (this.marksScored !== undefined && this.totalMarks !== undefined) {\n    this.percentage = (this.marksScored / this.totalMarks) * 100;\n    \n    // Calculate grade based on percentage\n    if (this.percentage >= 90) this.grade = 'A+';\n    else if (this.percentage >= 80) this.grade = 'A';\n    else if (this.percentage >= 70) this.grade = 'B+';\n    else if (this.percentage >= 60) this.grade = 'B';\n    else if (this.percentage >= 50) this.grade = 'C';\n    else if (this.percentage >= 40) this.grade = 'D';\n    else this.grade = 'F';\n  }\n});\n\nexport default mongoose.models.Mark || mongoose.model<IMark>('Mark', MarkSchema);\n"],"names":[],"mappings":";;;;AAAA;;AAiBA,MAAM,aAAa,IAAI,mHAAM,CAC3B;IACE,WAAW;QACT,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,UAAU;YAAC;YAAM;SAAyB;QAC1C,OAAO;IACT;IACA,UAAU;QACR,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,UAAU;YAAC;YAAM;SAAwB;QACzC,OAAO;IACT;IACA,QAAQ;QACN,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,UAAU;YAAC;YAAM;SAAsB;QACvC,OAAO;IACT;IACA,WAAW;QACT,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,UAAU;YAAC;YAAM;SAAyB;QAC1C,OAAO;IACT;IACA,aAAa;QACX,MAAM;QACN,UAAU;YAAC;YAAM;SAA2B;QAC5C,KAAK;IACP;IACA,YAAY;QACV,MAAM;QACN,KAAK;IACP;IACA,YAAY;QACV,MAAM;QACN,KAAK;QACL,KAAK;IACP;IACA,OAAO;QACL,MAAM;QACN,MAAM;IACR;IACA,SAAS;QACP,MAAM;QACN,MAAM;QACN,WAAW;IACb;IACA,UAAU;QACR,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;IACP;AACF,GACA;IACE,YAAY;AACd;AAGF,yCAAyC;AACzC,WAAW,KAAK,CAAC;IAAE,UAAU;IAAG,QAAQ;AAAE;AAC1C,WAAW,KAAK,CAAC;IAAE,WAAW;IAAG,QAAQ;IAAG,WAAW;AAAE,GAAG;IAAE,QAAQ;AAAK;AAC3E,WAAW,KAAK,CAAC;IAAE,QAAQ;IAAG,WAAW;AAAE;AAE3C,kDAAkD;AAClD,WAAW,GAAG,CAAC,QAAQ;IACrB,IAAI,IAAI,CAAC,WAAW,KAAK,aAAa,IAAI,CAAC,UAAU,KAAK,WAAW;QACnE,IAAI,CAAC,UAAU,GAAG,AAAC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,GAAI;QAEzD,sCAAsC;QACtC,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,IAAI,CAAC,KAAK,GAAG;aACnC,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,IAAI,CAAC,KAAK,GAAG;aACxC,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,IAAI,CAAC,KAAK,GAAG;aACxC,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,IAAI,CAAC,KAAK,GAAG;aACxC,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,IAAI,CAAC,KAAK,GAAG;aACxC,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,IAAI,CAAC,KAAK,GAAG;aACxC,IAAI,CAAC,KAAK,GAAG;IACpB;AACF;uCAEe,oHAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,oHAAQ,CAAC,KAAK,CAAQ,QAAQ"}},
    {"offset": {"line": 897, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/Content.ts"],"sourcesContent":["import mongoose, { Document, Model, Schema } from 'mongoose'\n\nexport type ContentType = 'video' | 'audio' | 'pdf' | 'text'\n\nexport interface IContent extends Document {\n  _id: string\n  title: string\n  description?: string\n  type: ContentType\n  url?: string // storage URL for video/audio/pdf\n  text?: string // inline text content when type=text\n  section: mongoose.Types.ObjectId\n  owner: mongoose.Types.ObjectId // teacher who uploaded\n  createdAt: Date\n  updatedAt: Date\n}\n\nconst ContentSchema = new Schema<IContent>({\n  title: { type: String, required: true },\n  description: { type: String },\n  type: { type: String, enum: ['video','audio','pdf','text'], required: true },\n  url: { type: String },\n  text: { type: String },\n  section: { type: Schema.Types.ObjectId, ref: 'Section', required: true },\n  owner: { type: Schema.Types.ObjectId, ref: 'User', required: true },\n}, { timestamps: true })\n\nContentSchema.index({ section: 1, createdAt: -1 })\n\nconst Content: Model<IContent> = mongoose.models.Content || mongoose.model<IContent>('Content', ContentSchema)\nexport default Content\n"],"names":[],"mappings":";;;;AAAA;;AAiBA,MAAM,gBAAgB,IAAI,mHAAM,CAAW;IACzC,OAAO;QAAE,MAAM;QAAQ,UAAU;IAAK;IACtC,aAAa;QAAE,MAAM;IAAO;IAC5B,MAAM;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAQ;YAAQ;YAAM;SAAO;QAAE,UAAU;IAAK;IAC3E,KAAK;QAAE,MAAM;IAAO;IACpB,MAAM;QAAE,MAAM;IAAO;IACrB,SAAS;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAW,UAAU;IAAK;IACvE,OAAO;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAQ,UAAU;IAAK;AACpE,GAAG;IAAE,YAAY;AAAK;AAEtB,cAAc,KAAK,CAAC;IAAE,SAAS;IAAG,WAAW,CAAC;AAAE;AAEhD,MAAM,UAA2B,oHAAQ,CAAC,MAAM,CAAC,OAAO,IAAI,oHAAQ,CAAC,KAAK,CAAW,WAAW;uCACjF"}},
    {"offset": {"line": 950, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/Course.ts"],"sourcesContent":["import mongoose, { Document, Model, Schema } from 'mongoose';\n\nexport interface ICourse extends Document {\n  _id: string;\n  title: string;\n  description: string;\n  instructor: mongoose.Types.ObjectId;\n  schoolId?: mongoose.Types.ObjectId;\n  category: string;\n  level: 'beginner' | 'intermediate' | 'advanced';\n  thumbnail?: string;\n  price: number;\n  duration: number; // in minutes\n  classes?: string[]; // Array of class names this course is assigned to\n  isPublished?: boolean;\n  createdBy?: mongoose.Types.ObjectId;\n  lessons: {\n    title: string;\n    description: string;\n    content: string;\n    videoUrl?: string;\n    duration: number;\n    order: number;\n  }[];\n  quizzes: {\n    title: string;\n    questions: {\n      question: string;\n      options: string[];\n      correctAnswer: number;\n      explanation?: string;\n    }[];\n    passingScore: number;\n  }[];\n  sections: mongoose.Types.ObjectId[]; // Sections this course is assigned to\n  enrolledStudents: mongoose.Types.ObjectId[];\n  rating: number;\n  reviews: {\n    user: mongoose.Types.ObjectId;\n    rating: number;\n    comment: string;\n    createdAt: Date;\n  }[];\n  status: 'draft' | 'published' | 'archived';\n  tags: string[];\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst CourseSchema = new Schema<ICourse>(\n  {\n    title: {\n      type: String,\n      required: [true, 'Please provide a course title'],\n      trim: true,\n      maxlength: [200, 'Title cannot be more than 200 characters'],\n    },\n    description: {\n      type: String,\n      required: [true, 'Please provide a course description'],\n      maxlength: [2000, 'Description cannot be more than 2000 characters'],\n    },\n    instructor: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n      required: true,\n    },\n    schoolId: {\n      type: Schema.Types.ObjectId,\n      ref: 'School',\n    },\n    createdBy: {\n      type: Schema.Types.ObjectId,\n      ref: 'User',\n    },\n    classes: [\n      {\n        type: String,\n        trim: true,\n      },\n    ],\n    isPublished: {\n      type: Boolean,\n      default: false,\n    },\n    category: {\n      type: String,\n      required: [true, 'Please specify a category'],\n      trim: true,\n    },\n    level: {\n      type: String,\n      enum: ['beginner', 'intermediate', 'advanced'],\n      default: 'beginner',\n    },\n    thumbnail: {\n      type: String,\n      default: '',\n    },\n    price: {\n      type: Number,\n      default: 0,\n      min: [0, 'Price cannot be negative'],\n    },\n    duration: {\n      type: Number,\n      required: true,\n      min: [0, 'Duration cannot be negative'],\n    },\n    lessons: [\n      {\n        title: {\n          type: String,\n          required: true,\n        },\n        description: String,\n        content: {\n          type: String,\n          required: true,\n        },\n        videoUrl: String,\n        duration: {\n          type: Number,\n          required: true,\n        },\n        order: {\n          type: Number,\n          required: true,\n        },\n      },\n    ],\n    quizzes: [\n      {\n        title: {\n          type: String,\n          required: true,\n        },\n        questions: [\n          {\n            question: {\n              type: String,\n              required: true,\n            },\n            options: {\n              type: [String],\n              required: true,\n              validate: {\n                validator: (v: string[]) => v.length >= 2,\n                message: 'At least 2 options are required',\n              },\n            },\n            correctAnswer: {\n              type: Number,\n              required: true,\n            },\n            explanation: String,\n          },\n        ],\n        passingScore: {\n          type: Number,\n          default: 70,\n          min: 0,\n          max: 100,\n        },\n      },\n    ],\n    sections: [\n      {\n        type: Schema.Types.ObjectId,\n        ref: 'Section',\n      },\n    ],\n    enrolledStudents: [\n      {\n        type: Schema.Types.ObjectId,\n        ref: 'User',\n      },\n    ],\n    rating: {\n      type: Number,\n      default: 0,\n      min: 0,\n      max: 5,\n    },\n    reviews: [\n      {\n        user: {\n          type: Schema.Types.ObjectId,\n          ref: 'User',\n          required: true,\n        },\n        rating: {\n          type: Number,\n          required: true,\n          min: 1,\n          max: 5,\n        },\n        comment: {\n          type: String,\n          maxlength: [1000, 'Comment cannot be more than 1000 characters'],\n        },\n        createdAt: {\n          type: Date,\n          default: Date.now,\n        },\n      },\n    ],\n    status: {\n      type: String,\n      enum: ['draft', 'published', 'archived'],\n      default: 'draft',\n    },\n    tags: {\n      type: [String],\n      default: [],\n    },\n  },\n  {\n    timestamps: true,\n  }\n);\n\n// Indexes for better query performance\nCourseSchema.index({ title: 'text', description: 'text' });\nCourseSchema.index({ instructor: 1 });\nCourseSchema.index({ schoolId: 1 });\nCourseSchema.index({ category: 1, level: 1 });\nCourseSchema.index({ status: 1 });\nCourseSchema.index({ rating: -1 });\n\nconst Course: Model<ICourse> =\n  mongoose.models.Course || mongoose.model<ICourse>('Course', CourseSchema);\n\nexport default Course;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1188, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/OfflineContent.ts"],"sourcesContent":["import mongoose, { Document } from 'mongoose'\n\nexport interface IOfflineContent extends Document {\n  userId: mongoose.Schema.Types.ObjectId\n  courseId: mongoose.Schema.Types.ObjectId\n  lessonId?: mongoose.Schema.Types.ObjectId\n  contentType: 'video' | 'pdf' | 'notes' | 'quiz'\n  fileName: string\n  fileSize: number\n  downloadedAt: Date\n  lastAccessedAt: Date\n  syncStatus: 'pending' | 'synced' | 'outdated'\n}\n\nconst OfflineContentSchema = new mongoose.Schema({\n  userId: { type: mongoose.Schema.Types.ObjectId, ref: 'User', required: true },\n  courseId: { type: mongoose.Schema.Types.ObjectId, ref: 'Course', required: true },\n  lessonId: { type: mongoose.Schema.Types.ObjectId },\n  contentType: { type: String, enum: ['video', 'pdf', 'notes', 'quiz'], required: true },\n  fileName: { type: String, required: true },\n  fileSize: { type: Number, required: true },\n  downloadedAt: { type: Date, default: Date.now },\n  lastAccessedAt: { type: Date, default: Date.now },\n  syncStatus: { type: String, enum: ['pending', 'synced', 'outdated'], default: 'synced' }\n}, { timestamps: true })\n\nOfflineContentSchema.index({ userId: 1, courseId: 1 })\nOfflineContentSchema.index({ syncStatus: 1 })\n\nexport default mongoose.models.OfflineContent || mongoose.model<IOfflineContent>('OfflineContent', OfflineContentSchema)\n"],"names":[],"mappings":";;;;AAAA;;AAcA,MAAM,uBAAuB,IAAI,oHAAQ,CAAC,MAAM,CAAC;IAC/C,QAAQ;QAAE,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAQ,UAAU;IAAK;IAC5E,UAAU;QAAE,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAU,UAAU;IAAK;IAChF,UAAU;QAAE,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;IAAC;IACjD,aAAa;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAS;YAAO;YAAS;SAAO;QAAE,UAAU;IAAK;IACrF,UAAU;QAAE,MAAM;QAAQ,UAAU;IAAK;IACzC,UAAU;QAAE,MAAM;QAAQ,UAAU;IAAK;IACzC,cAAc;QAAE,MAAM;QAAM,SAAS,KAAK,GAAG;IAAC;IAC9C,gBAAgB;QAAE,MAAM;QAAM,SAAS,KAAK,GAAG;IAAC;IAChD,YAAY;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAW;YAAU;SAAW;QAAE,SAAS;IAAS;AACzF,GAAG;IAAE,YAAY;AAAK;AAEtB,qBAAqB,KAAK,CAAC;IAAE,QAAQ;IAAG,UAAU;AAAE;AACpD,qBAAqB,KAAK,CAAC;IAAE,YAAY;AAAE;uCAE5B,oHAAQ,CAAC,MAAM,CAAC,cAAc,IAAI,oHAAQ,CAAC,KAAK,CAAkB,kBAAkB"}},
    {"offset": {"line": 1258, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/Section.ts"],"sourcesContent":["import mongoose, { Document, Model, Schema } from 'mongoose'\n\nexport interface ISection extends Document {\n  _id: string\n  name: string\n  owner: mongoose.Types.ObjectId // teacher/admin who created\n  students: mongoose.Types.ObjectId[]\n  createdAt: Date\n  updatedAt: Date\n}\n\nconst SectionSchema = new Schema<ISection>({\n  name: { type: String, required: true, trim: true },\n  owner: { type: Schema.Types.ObjectId, ref: 'User', required: true },\n  students: [{ type: Schema.Types.ObjectId, ref: 'User' }],\n}, { timestamps: true })\n\nSectionSchema.index({ owner: 1, name: 1 }, { unique: true })\n\nconst Section: Model<ISection> = mongoose.models.Section || mongoose.model<ISection>('Section', SectionSchema)\nexport default Section\n"],"names":[],"mappings":";;;;AAAA;;AAWA,MAAM,gBAAgB,IAAI,mHAAM,CAAW;IACzC,MAAM;QAAE,MAAM;QAAQ,UAAU;QAAM,MAAM;IAAK;IACjD,OAAO;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAQ,UAAU;IAAK;IAClE,UAAU;QAAC;YAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;YAAE,KAAK;QAAO;KAAE;AAC1D,GAAG;IAAE,YAAY;AAAK;AAEtB,cAAc,KAAK,CAAC;IAAE,OAAO;IAAG,MAAM;AAAE,GAAG;IAAE,QAAQ;AAAK;AAE1D,MAAM,UAA2B,oHAAQ,CAAC,MAAM,CAAC,OAAO,IAAI,oHAAQ,CAAC,KAAK,CAAW,WAAW;uCACjF"}},
    {"offset": {"line": 1296, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/ChatMessage.ts"],"sourcesContent":["import mongoose, { Document, Model, Schema } from 'mongoose'\n\nexport interface IChatMessage extends Document {\n  _id: string\n  userId: mongoose.Types.ObjectId\n  userName: string\n  role: 'user' | 'assistant'\n  content: string\n  language: string\n  quizMode: boolean\n  timestamp: Date\n}\n\nconst ChatMessageSchema = new Schema<IChatMessage>({\n  userId: { type: Schema.Types.ObjectId, ref: 'User', required: true },\n  userName: { type: String, required: true },\n  role: { type: String, enum: ['user', 'assistant'], required: true },\n  content: { type: String, required: true },\n  language: { type: String, default: 'english' },\n  quizMode: { type: Boolean, default: false },\n  timestamp: { type: Date, default: Date.now }\n}, { timestamps: true })\n\n// Indexes for performance\nChatMessageSchema.index({ userId: 1, timestamp: -1 })\nChatMessageSchema.index({ userName: 1, timestamp: -1 })\nChatMessageSchema.index({ quizMode: 1 })\n\nconst ChatMessage: Model<IChatMessage> = mongoose.models.ChatMessage || mongoose.model<IChatMessage>('ChatMessage', ChatMessageSchema)\nexport default ChatMessage\n"],"names":[],"mappings":";;;;AAAA;;AAaA,MAAM,oBAAoB,IAAI,mHAAM,CAAe;IACjD,QAAQ;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAQ,UAAU;IAAK;IACnE,UAAU;QAAE,MAAM;QAAQ,UAAU;IAAK;IACzC,MAAM;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAQ;SAAY;QAAE,UAAU;IAAK;IAClE,SAAS;QAAE,MAAM;QAAQ,UAAU;IAAK;IACxC,UAAU;QAAE,MAAM;QAAQ,SAAS;IAAU;IAC7C,UAAU;QAAE,MAAM;QAAS,SAAS;IAAM;IAC1C,WAAW;QAAE,MAAM;QAAM,SAAS,KAAK,GAAG;IAAC;AAC7C,GAAG;IAAE,YAAY;AAAK;AAEtB,0BAA0B;AAC1B,kBAAkB,KAAK,CAAC;IAAE,QAAQ;IAAG,WAAW,CAAC;AAAE;AACnD,kBAAkB,KAAK,CAAC;IAAE,UAAU;IAAG,WAAW,CAAC;AAAE;AACrD,kBAAkB,KAAK,CAAC;IAAE,UAAU;AAAE;AAEtC,MAAM,cAAmC,oHAAQ,CAAC,MAAM,CAAC,WAAW,IAAI,oHAAQ,CAAC,KAAK,CAAe,eAAe;uCACrG"}},
    {"offset": {"line": 1357, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/Gamification.ts"],"sourcesContent":["import mongoose, { Document } from 'mongoose'\n\nexport interface IGamification extends Document {\n  userId: mongoose.Schema.Types.ObjectId\n  xp: number\n  level: number\n  streak: number\n  lastActivityDate: Date\n  badges: Array<{\n    id: string\n    name: string\n    description: string\n    icon: string\n    earnedAt: Date\n  }>\n  achievements: Array<{\n    id: string\n    title: string\n    progress: number\n    target: number\n    completed: boolean\n  }>\n}\n\nconst GamificationSchema = new mongoose.Schema({\n  userId: { type: mongoose.Schema.Types.ObjectId, ref: 'User', required: true, unique: true },\n  xp: { type: Number, default: 0 },\n  level: { type: Number, default: 1 },\n  streak: { type: Number, default: 0 },\n  lastActivityDate: { type: Date, default: null },\n  badges: [{\n    id: { type: String, required: true },\n    name: { type: String, required: true },\n    description: String,\n    icon: String,\n    earnedAt: { type: Date, default: Date.now }\n  }],\n  achievements: [{\n    id: { type: String, required: true },\n    title: { type: String, required: true },\n    progress: { type: Number, default: 0 },\n    target: { type: Number, required: true },\n    completed: { type: Boolean, default: false }\n  }]\n}, { timestamps: true })\n\nGamificationSchema.index({ userId: 1 })\nGamificationSchema.index({ xp: -1 })\nGamificationSchema.index({ level: -1 })\n\nexport default mongoose.models.Gamification || mongoose.model<IGamification>('Gamification', GamificationSchema)\n"],"names":[],"mappings":";;;;AAAA;;AAwBA,MAAM,qBAAqB,IAAI,oHAAQ,CAAC,MAAM,CAAC;IAC7C,QAAQ;QAAE,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAQ,UAAU;QAAM,QAAQ;IAAK;IAC1F,IAAI;QAAE,MAAM;QAAQ,SAAS;IAAE;IAC/B,OAAO;QAAE,MAAM;QAAQ,SAAS;IAAE;IAClC,QAAQ;QAAE,MAAM;QAAQ,SAAS;IAAE;IACnC,kBAAkB;QAAE,MAAM;QAAM,SAAS;IAAK;IAC9C,QAAQ;QAAC;YACP,IAAI;gBAAE,MAAM;gBAAQ,UAAU;YAAK;YACnC,MAAM;gBAAE,MAAM;gBAAQ,UAAU;YAAK;YACrC,aAAa;YACb,MAAM;YACN,UAAU;gBAAE,MAAM;gBAAM,SAAS,KAAK,GAAG;YAAC;QAC5C;KAAE;IACF,cAAc;QAAC;YACb,IAAI;gBAAE,MAAM;gBAAQ,UAAU;YAAK;YACnC,OAAO;gBAAE,MAAM;gBAAQ,UAAU;YAAK;YACtC,UAAU;gBAAE,MAAM;gBAAQ,SAAS;YAAE;YACrC,QAAQ;gBAAE,MAAM;gBAAQ,UAAU;YAAK;YACvC,WAAW;gBAAE,MAAM;gBAAS,SAAS;YAAM;QAC7C;KAAE;AACJ,GAAG;IAAE,YAAY;AAAK;AAEtB,mBAAmB,KAAK,CAAC;IAAE,QAAQ;AAAE;AACrC,mBAAmB,KAAK,CAAC;IAAE,IAAI,CAAC;AAAE;AAClC,mBAAmB,KAAK,CAAC;IAAE,OAAO,CAAC;AAAE;uCAEtB,oHAAQ,CAAC,MAAM,CAAC,YAAY,IAAI,oHAAQ,CAAC,KAAK,CAAgB,gBAAgB"}},
    {"offset": {"line": 1445, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/index.ts"],"sourcesContent":["// Core Models\nexport { default as School } from './School';\nexport type { ISchool } from './School';\nexport { default as User } from './User';\nexport type { IUser } from './User';\n\n// Academic Structure Models\nexport { default as Class } from './Class';\nexport type { IClass } from './Class';\nexport { default as Subject } from './Subject';\nexport type { ISubject } from './Subject';\n\n// Assessment Models\nexport { default as Attendance } from './Attendance';\nexport type { IAttendance } from './Attendance';\nexport { default as Exam } from './Exam';\nexport type { IExam } from './Exam';\nexport { default as Mark } from './Mark';\nexport type { IMark } from './Mark';\n\n// Learning Management Models\nexport { default as Content } from './Content';\nexport type { IContent } from './Content';\nexport { default as Course } from './Course';\nexport type { ICourse } from './Course';\nexport { default as OfflineContent } from './OfflineContent';\nexport type { IOfflineContent } from './OfflineContent';\nexport { default as Section } from './Section';\nexport type { ISection } from './Section';\n\n// Engagement Models\nexport { default as ChatMessage } from './ChatMessage';\nexport type { IChatMessage } from './ChatMessage';\nexport { default as Gamification } from './Gamification';\nexport type { IGamification } from './Gamification';\n\n"],"names":[],"mappings":"AAAA,cAAc;;AACd;AAEA;AAGA,4BAA4B;AAC5B;AAEA;AAGA,oBAAoB;AACpB;AAEA;AAEA;AAGA,6BAA6B;AAC7B;AAEA;AAEA;AAEA;AAGA,oBAAoB;AACpB;AAEA"}},
    {"offset": {"line": 1490, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/mongodb.ts"],"sourcesContent":["import mongoose from 'mongoose';\n\nconst MONGODB_URI = process.env.MONGODB_URI as string;\n\nif (!MONGODB_URI) {\n  throw new Error(\n    'Please define the MONGODB_URI environment variable inside .env.local'\n  );\n}\n\n/**\n * Global is used here to maintain a cached connection across hot reloads\n * in development. This prevents connections growing exponentially\n * during API Route usage.\n */\ninterface MongooseCache {\n  conn: typeof mongoose | null;\n  promise: Promise<typeof mongoose> | null;\n}\n\ndeclare global {\n  var mongoose: MongooseCache | undefined;\n}\n\nlet cached: MongooseCache = global.mongoose || { conn: null, promise: null };\n\nif (!global.mongoose) {\n  global.mongoose = cached;\n}\n\nasync function connectDB(): Promise<typeof mongoose> {\n  if (cached.conn) {\n    return cached.conn;\n  }\n\n  if (!cached.promise) {\n    const opts = {\n      bufferCommands: false,\n      serverSelectionTimeoutMS: 30000,\n      socketTimeoutMS: 75000,\n      connectTimeoutMS: 30000,\n      maxPoolSize: 10,\n      minPoolSize: 1,\n      retryWrites: true,\n      retryReads: true,\n      // Disable TLS validation to fix Node.js 22 SSL error\n      tls: true,\n      tlsAllowInvalidCertificates: true,\n      tlsAllowInvalidHostnames: true,\n    };\n\n    cached.promise = mongoose.connect(MONGODB_URI, opts).then((mongoose) => {\n      console.log(' MongoDB connected successfully');\n      return mongoose;\n    }).catch((err) => {\n      console.error(' MongoDB connection error:', err.message);\n      cached.promise = null;\n      throw err;\n    });\n  }\n\n  try {\n    cached.conn = await cached.promise;\n  } catch (e) {\n    cached.promise = null;\n    console.error(' MongoDB connection error:', e);\n    throw e;\n  }\n\n  return cached.conn;\n}\n\nexport default connectDB;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAE3C,IAAI,CAAC,aAAa;IAChB,MAAM,IAAI,MACR;AAEJ;AAgBA,IAAI,SAAwB,OAAO,QAAQ,IAAI;IAAE,MAAM;IAAM,SAAS;AAAK;AAE3E,IAAI,CAAC,OAAO,QAAQ,EAAE;IACpB,OAAO,QAAQ,GAAG;AACpB;AAEA,eAAe;IACb,IAAI,OAAO,IAAI,EAAE;QACf,OAAO,OAAO,IAAI;IACpB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YACX,gBAAgB;YAChB,0BAA0B;YAC1B,iBAAiB;YACjB,kBAAkB;YAClB,aAAa;YACb,aAAa;YACb,aAAa;YACb,YAAY;YACZ,qDAAqD;YACrD,KAAK;YACL,6BAA6B;YAC7B,0BAA0B;QAC5B;QAEA,OAAO,OAAO,GAAG,oHAAQ,CAAC,OAAO,CAAC,aAAa,MAAM,IAAI,CAAC,CAAC;YACzD,QAAQ,GAAG,CAAC;YACZ,OAAO;QACT,GAAG,KAAK,CAAC,CAAC;YACR,QAAQ,KAAK,CAAC,+BAA+B,IAAI,OAAO;YACxD,OAAO,OAAO,GAAG;YACjB,MAAM;QACR;IACF;IAEA,IAAI;QACF,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IACpC,EAAE,OAAO,GAAG;QACV,OAAO,OAAO,GAAG;QACjB,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,MAAM;IACR;IAEA,OAAO,OAAO,IAAI;AACpB;uCAEe"}},
    {"offset": {"line": 1549, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/app/api/student/offline-content/route.ts"],"sourcesContent":["import { getSession } from '@/lib/auth'\nimport { OfflineContent } from '@/lib/models'\nimport connectDB from '@/lib/mongodb'\nimport { NextRequest, NextResponse } from 'next/server'\n\nexport async function GET(request: NextRequest) {\n  try {\n    const session = await getSession()\n    if (!session || session.role !== 'student') {\n      return NextResponse.json({ success: false, error: 'Unauthorized' }, { status: 401 })\n    }\n\n    await connectDB()\n\n    const downloads = await OfflineContent.find({ userId: session.id })\n      .populate('courseId', 'title thumbnail')\n      .sort({ downloadedAt: -1 })\n      .lean()\n\n    const downloadData = downloads.map((d: any) => ({\n      _id: String(d._id),\n      course: {\n        _id: String(d.courseId?._id),\n        title: d.courseId?.title || 'Unknown',\n        thumbnail: d.courseId?.thumbnail\n      },\n      contentType: d.contentType,\n      fileName: d.fileName,\n      fileSize: d.fileSize,\n      downloadedAt: d.downloadedAt.toISOString(),\n      lastAccessedAt: d.lastAccessedAt.toISOString(),\n      syncStatus: d.syncStatus\n    }))\n\n    return NextResponse.json({ success: true, data: downloadData }, { status: 200 })\n  } catch (error: any) {\n    console.error('Error fetching offline content:', error)\n    return NextResponse.json({ success: false, error: error.message }, { status: 500 })\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const session = await getSession()\n    if (!session || session.role !== 'student') {\n      return NextResponse.json({ success: false, error: 'Unauthorized' }, { status: 401 })\n    }\n\n    const { courseId, lessonId, contentType, fileName, fileSize } = await request.json()\n\n    await connectDB()\n\n    // Check if already exists\n    const existing = await OfflineContent.findOne({\n      userId: session.id,\n      courseId,\n      lessonId: lessonId || null,\n      contentType\n    })\n\n    if (existing) {\n      existing.lastAccessedAt = new Date()\n      await existing.save()\n      return NextResponse.json({ success: true, data: existing }, { status: 200 })\n    }\n\n    const offlineContent = await OfflineContent.create({\n      userId: session.id,\n      courseId,\n      lessonId: lessonId || undefined,\n      contentType,\n      fileName,\n      fileSize,\n      syncStatus: 'synced'\n    })\n\n    return NextResponse.json({ success: true, data: offlineContent }, { status: 201 })\n  } catch (error: any) {\n    console.error('Error saving offline content:', error)\n    return NextResponse.json({ success: false, error: error.message }, { status: 500 })\n  }\n}\n\nexport async function DELETE(request: NextRequest) {\n  try {\n    const session = await getSession()\n    if (!session || session.role !== 'student') {\n      return NextResponse.json({ success: false, error: 'Unauthorized' }, { status: 401 })\n    }\n\n    const { searchParams } = new URL(request.url)\n    const contentId = searchParams.get('id')\n\n    if (!contentId) {\n      return NextResponse.json({ success: false, error: 'Content ID required' }, { status: 400 })\n    }\n\n    await connectDB()\n\n    const content = await OfflineContent.findOneAndDelete({\n      _id: contentId,\n      userId: session.id\n    })\n\n    if (!content) {\n      return NextResponse.json({ success: false, error: 'Content not found' }, { status: 404 })\n    }\n\n    return NextResponse.json({ success: true, message: 'Content deleted' }, { status: 200 })\n  } catch (error: any) {\n    console.error('Error deleting offline content:', error)\n    return NextResponse.json({ success: false, error: error.message }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}