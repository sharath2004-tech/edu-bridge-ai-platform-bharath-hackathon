{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/School.ts"],"sourcesContent":["import mongoose, { Document, Model, Schema } from 'mongoose';\n\nexport interface ISchool extends Document {\n  _id: string;\n  name: string;\n  code: string; // Unique school code for registration\n  email: string;\n  phone?: string;\n  address: {\n    street?: string;\n    city: string;\n    state: string;\n    country: string;\n    zipCode?: string;\n  };\n  principal?: {\n    name: string;\n    email: string;\n    phone?: string;\n  };\n  logo?: string;\n  website?: string;\n  established?: Date;\n  type: 'primary' | 'secondary' | 'higher-secondary' | 'university' | 'institute';\n  board?: string; // CBSE, ICSE, State Board, etc.\n  isActive: boolean;\n  subscription?: {\n    plan: 'free' | 'basic' | 'premium' | 'enterprise';\n    startDate: Date;\n    endDate?: Date;\n    maxStudents?: number;\n    maxTeachers?: number;\n  };\n  stats?: {\n    totalStudents: number;\n    totalTeachers: number;\n    totalCourses: number;\n  };\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst SchoolSchema = new Schema<ISchool>(\n  {\n    name: {\n      type: String,\n      required: [true, 'School name is required'],\n      trim: true,\n      maxlength: [200, 'School name cannot exceed 200 characters'],\n    },\n    code: {\n      type: String,\n      required: [true, 'School code is required'],\n      unique: true,\n      uppercase: true,\n      trim: true,\n      match: [/^[A-Z0-9]{4,10}$/, 'School code must be 4-10 alphanumeric characters'],\n    },\n    email: {\n      type: String,\n      required: [true, 'School email is required'],\n      unique: true,\n      lowercase: true,\n      trim: true,\n      match: [\n        /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/,\n        'Please provide a valid email',\n      ],\n    },\n    phone: {\n      type: String,\n      trim: true,\n    },\n    address: {\n      street: String,\n      city: {\n        type: String,\n        required: [true, 'City is required'],\n      },\n      state: {\n        type: String,\n        required: [true, 'State is required'],\n      },\n      country: {\n        type: String,\n        required: [true, 'Country is required'],\n        default: 'India',\n      },\n      zipCode: String,\n    },\n    principal: {\n      name: String,\n      email: String,\n      phone: String,\n    },\n    logo: {\n      type: String,\n      default: '',\n    },\n    website: {\n      type: String,\n      trim: true,\n    },\n    established: {\n      type: Date,\n    },\n    type: {\n      type: String,\n      enum: ['primary', 'secondary', 'higher-secondary', 'university', 'institute'],\n      default: 'secondary',\n      required: true,\n    },\n    board: {\n      type: String,\n      default: 'CBSE',\n    },\n    isActive: {\n      type: Boolean,\n      default: true,\n    },\n    subscription: {\n      plan: {\n        type: String,\n        enum: ['free', 'basic', 'premium', 'enterprise'],\n        default: 'free',\n      },\n      startDate: {\n        type: Date,\n        default: Date.now,\n      },\n      endDate: Date,\n      maxStudents: {\n        type: Number,\n        default: 100,\n      },\n      maxTeachers: {\n        type: Number,\n        default: 10,\n      },\n    },\n    stats: {\n      totalStudents: {\n        type: Number,\n        default: 0,\n      },\n      totalTeachers: {\n        type: Number,\n        default: 0,\n      },\n      totalCourses: {\n        type: Number,\n        default: 0,\n      },\n    },\n  },\n  {\n    timestamps: true,\n  }\n);\n\n// Indexes for better query performance\n// Note: code and email already have indexes from schema definitions\nSchoolSchema.index({ isActive: 1 });\nSchoolSchema.index({ 'subscription.plan': 1 });\n\nconst School: Model<ISchool> =\n  mongoose.models.School || mongoose.model<ISchool>('School', SchoolSchema);\n\nexport default School;\n"],"names":[],"mappings":";;;;AAAA;;AA0CA,MAAM,eAAe,IAAI,mHAAM,CAC7B;IACE,MAAM;QACJ,MAAM;QACN,UAAU;YAAC;YAAM;SAA0B;QAC3C,MAAM;QACN,WAAW;YAAC;YAAK;SAA2C;IAC9D;IACA,MAAM;QACJ,MAAM;QACN,UAAU;YAAC;YAAM;SAA0B;QAC3C,QAAQ;QACR,WAAW;QACX,MAAM;QACN,OAAO;YAAC;YAAoB;SAAmD;IACjF;IACA,OAAO;QACL,MAAM;QACN,UAAU;YAAC;YAAM;SAA2B;QAC5C,QAAQ;QACR,WAAW;QACX,MAAM;QACN,OAAO;YACL;YACA;SACD;IACH;IACA,OAAO;QACL,MAAM;QACN,MAAM;IACR;IACA,SAAS;QACP,QAAQ;QACR,MAAM;YACJ,MAAM;YACN,UAAU;gBAAC;gBAAM;aAAmB;QACtC;QACA,OAAO;YACL,MAAM;YACN,UAAU;gBAAC;gBAAM;aAAoB;QACvC;QACA,SAAS;YACP,MAAM;YACN,UAAU;gBAAC;gBAAM;aAAsB;YACvC,SAAS;QACX;QACA,SAAS;IACX;IACA,WAAW;QACT,MAAM;QACN,OAAO;QACP,OAAO;IACT;IACA,MAAM;QACJ,MAAM;QACN,SAAS;IACX;IACA,SAAS;QACP,MAAM;QACN,MAAM;IACR;IACA,aAAa;QACX,MAAM;IACR;IACA,MAAM;QACJ,MAAM;QACN,MAAM;YAAC;YAAW;YAAa;YAAoB;YAAc;SAAY;QAC7E,SAAS;QACT,UAAU;IACZ;IACA,OAAO;QACL,MAAM;QACN,SAAS;IACX;IACA,UAAU;QACR,MAAM;QACN,SAAS;IACX;IACA,cAAc;QACZ,MAAM;YACJ,MAAM;YACN,MAAM;gBAAC;gBAAQ;gBAAS;gBAAW;aAAa;YAChD,SAAS;QACX;QACA,WAAW;YACT,MAAM;YACN,SAAS,KAAK,GAAG;QACnB;QACA,SAAS;QACT,aAAa;YACX,MAAM;YACN,SAAS;QACX;QACA,aAAa;YACX,MAAM;YACN,SAAS;QACX;IACF;IACA,OAAO;QACL,eAAe;YACb,MAAM;YACN,SAAS;QACX;QACA,eAAe;YACb,MAAM;YACN,SAAS;QACX;QACA,cAAc;YACZ,MAAM;YACN,SAAS;QACX;IACF;AACF,GACA;IACE,YAAY;AACd;AAGF,uCAAuC;AACvC,oEAAoE;AACpE,aAAa,KAAK,CAAC;IAAE,UAAU;AAAE;AACjC,aAAa,KAAK,CAAC;IAAE,qBAAqB;AAAE;AAE5C,MAAM,SACJ,oHAAQ,CAAC,MAAM,CAAC,MAAM,IAAI,oHAAQ,CAAC,KAAK,CAAU,UAAU;uCAE/C"}},
    {"offset": {"line": 215, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/models/User.ts"],"sourcesContent":["import mongoose, { Document, Model, Schema } from 'mongoose';\n\nexport interface IUser extends Document {\n  _id: string;\n  name: string;\n  email: string;\n  password: string;\n  role: 'super-admin' | 'principal' | 'teacher' | 'student';\n  schoolId?: mongoose.Types.ObjectId;\n  avatar?: string;\n  bio?: string;\n  phone?: string;\n  isActive: boolean;\n  // Teacher-specific fields\n  subjectSpecialization?: string;\n  teacherRole?: 'Teacher' | 'HOD' | 'Vice Principal';\n  assignedClasses?: mongoose.Types.ObjectId[]; // Array of Class IDs\n  assignedSubjects?: mongoose.Types.ObjectId[]; // Array of Subject IDs\n  // Student-specific fields\n  classId?: mongoose.Types.ObjectId; // Reference to Class model\n  rollNo?: number;\n  parentName?: string;\n  parentPhone?: string;\n  // Legacy fields (for backward compatibility)\n  className?: string; // e.g., '10-A'\n  section?: string; // e.g., 'A', 'B', 'C', 'D', 'E'\n  rollNumber?: string;\n  enrolledCourses?: mongoose.Types.ObjectId[];\n  // Teacher fields\n  createdCourses?: mongoose.Types.ObjectId[];\n  progress?: {\n    courseId: mongoose.Types.ObjectId;\n    completedLessons: number;\n    totalLessons: number;\n    lastAccessed: Date;\n  }[];\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst UserSchema = new Schema<IUser>(\n  {\n    name: {\n      type: String,\n      required: [true, 'Please provide a name'],\n      trim: true,\n      maxlength: [100, 'Name cannot be more than 100 characters'],\n    },\n    email: {\n      type: String,\n      required: [true, 'Please provide an email'],\n      unique: true,\n      lowercase: true,\n      trim: true,\n      match: [\n        /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/,\n        'Please provide a valid email',\n      ],\n    },\n    password: {\n      type: String,\n      required: [true, 'Please provide a password'],\n      minlength: [6, 'Password must be at least 6 characters'],\n      select: false, // Don't return password by default\n    },\n    role: {\n      type: String,\n      enum: ['super-admin', 'principal', 'teacher', 'student'],\n      default: 'student',\n      required: true,\n    },\n    schoolId: {\n      type: Schema.Types.ObjectId,\n      ref: 'School',\n    },\n    avatar: {\n      type: String,\n      default: '',\n    },\n    bio: {\n      type: String,\n      maxlength: [500, 'Bio cannot be more than 500 characters'],\n    },\n    phone: {\n      type: String,\n      trim: true,\n    },\n    isActive: {\n      type: Boolean,\n      default: true,\n    },\n    // Teacher-specific fields\n    subjectSpecialization: {\n      type: String,\n      trim: true,\n    },\n    teacherRole: {\n      type: String,\n      enum: ['Teacher', 'HOD', 'Vice Principal'],\n    },\n    assignedClasses: [\n      {\n        type: Schema.Types.ObjectId,\n        ref: 'Class',\n      },\n    ],\n    assignedSubjects: [\n      {\n        type: Schema.Types.ObjectId,\n        ref: 'Subject',\n      },\n    ],\n    // Student-specific fields\n    classId: {\n      type: Schema.Types.ObjectId,\n      ref: 'Class',\n      index: true,\n    },\n    rollNo: {\n      type: Number,\n      min: 1,\n    },\n    parentName: {\n      type: String,\n      trim: true,\n    },\n    parentPhone: {\n      type: String,\n      trim: true,\n    },\n    // Legacy fields (backward compatibility)\n    className: {\n      type: String,\n      trim: true,\n    },\n    section: {\n      type: String,\n      trim: true,\n    },\n    rollNumber: {\n      type: String,\n      trim: true,\n    },\n    enrolledCourses: [\n      {\n        type: Schema.Types.ObjectId,\n        ref: 'Course',\n      },\n    ],\n    createdCourses: [\n      {\n        type: Schema.Types.ObjectId,\n        ref: 'Course',\n      },\n    ],\n    progress: [\n      {\n        courseId: {\n          type: Schema.Types.ObjectId,\n          ref: 'Course',\n        },\n        completedLessons: {\n          type: Number,\n          default: 0,\n        },\n        totalLessons: {\n          type: Number,\n          default: 0,\n        },\n        lastAccessed: {\n          type: Date,\n          default: Date.now,\n        },\n      },\n    ],\n  },\n  {\n    timestamps: true,\n  }\n);\n\n// Indexes for better query performance\nUserSchema.index({ role: 1 });\nUserSchema.index({ schoolId: 1, role: 1 });\n// email already has unique index from schema definition\n\nconst User: Model<IUser> =\n  mongoose.models.User || mongoose.model<IUser>('User', UserSchema);\n\nexport default User;\n"],"names":[],"mappings":";;;;AAAA;;AAwCA,MAAM,aAAa,IAAI,mHAAM,CAC3B;IACE,MAAM;QACJ,MAAM;QACN,UAAU;YAAC;YAAM;SAAwB;QACzC,MAAM;QACN,WAAW;YAAC;YAAK;SAA0C;IAC7D;IACA,OAAO;QACL,MAAM;QACN,UAAU;YAAC;YAAM;SAA0B;QAC3C,QAAQ;QACR,WAAW;QACX,MAAM;QACN,OAAO;YACL;YACA;SACD;IACH;IACA,UAAU;QACR,MAAM;QACN,UAAU;YAAC;YAAM;SAA4B;QAC7C,WAAW;YAAC;YAAG;SAAyC;QACxD,QAAQ;IACV;IACA,MAAM;QACJ,MAAM;QACN,MAAM;YAAC;YAAe;YAAa;YAAW;SAAU;QACxD,SAAS;QACT,UAAU;IACZ;IACA,UAAU;QACR,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;IACP;IACA,QAAQ;QACN,MAAM;QACN,SAAS;IACX;IACA,KAAK;QACH,MAAM;QACN,WAAW;YAAC;YAAK;SAAyC;IAC5D;IACA,OAAO;QACL,MAAM;QACN,MAAM;IACR;IACA,UAAU;QACR,MAAM;QACN,SAAS;IACX;IACA,0BAA0B;IAC1B,uBAAuB;QACrB,MAAM;QACN,MAAM;IACR;IACA,aAAa;QACX,MAAM;QACN,MAAM;YAAC;YAAW;YAAO;SAAiB;IAC5C;IACA,iBAAiB;QACf;YACE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;YAC3B,KAAK;QACP;KACD;IACD,kBAAkB;QAChB;YACE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;YAC3B,KAAK;QACP;KACD;IACD,0BAA0B;IAC1B,SAAS;QACP,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,OAAO;IACT;IACA,QAAQ;QACN,MAAM;QACN,KAAK;IACP;IACA,YAAY;QACV,MAAM;QACN,MAAM;IACR;IACA,aAAa;QACX,MAAM;QACN,MAAM;IACR;IACA,yCAAyC;IACzC,WAAW;QACT,MAAM;QACN,MAAM;IACR;IACA,SAAS;QACP,MAAM;QACN,MAAM;IACR;IACA,YAAY;QACV,MAAM;QACN,MAAM;IACR;IACA,iBAAiB;QACf;YACE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;YAC3B,KAAK;QACP;KACD;IACD,gBAAgB;QACd;YACE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;YAC3B,KAAK;QACP;KACD;IACD,UAAU;QACR;YACE,UAAU;gBACR,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;gBAC3B,KAAK;YACP;YACA,kBAAkB;gBAChB,MAAM;gBACN,SAAS;YACX;YACA,cAAc;gBACZ,MAAM;gBACN,SAAS;YACX;YACA,cAAc;gBACZ,MAAM;gBACN,SAAS,KAAK,GAAG;YACnB;QACF;KACD;AACH,GACA;IACE,YAAY;AACd;AAGF,uCAAuC;AACvC,WAAW,KAAK,CAAC;IAAE,MAAM;AAAE;AAC3B,WAAW,KAAK,CAAC;IAAE,UAAU;IAAG,MAAM;AAAE;AACxC,wDAAwD;AAExD,MAAM,OACJ,oHAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,oHAAQ,CAAC,KAAK,CAAQ,QAAQ;uCAEzC"}},
    {"offset": {"line": 400, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/mongodb.ts"],"sourcesContent":["import mongoose from 'mongoose';\n\nconst MONGODB_URI = process.env.MONGODB_URI as string;\n\nif (!MONGODB_URI) {\n  throw new Error(\n    'Please define the MONGODB_URI environment variable inside .env.local'\n  );\n}\n\n/**\n * Global is used here to maintain a cached connection across hot reloads\n * in development. This prevents connections growing exponentially\n * during API Route usage.\n */\ninterface MongooseCache {\n  conn: typeof mongoose | null;\n  promise: Promise<typeof mongoose> | null;\n}\n\ndeclare global {\n  var mongoose: MongooseCache | undefined;\n}\n\nlet cached: MongooseCache = global.mongoose || { conn: null, promise: null };\n\nif (!global.mongoose) {\n  global.mongoose = cached;\n}\n\nasync function connectDB(): Promise<typeof mongoose> {\n  if (cached.conn) {\n    return cached.conn;\n  }\n\n  if (!cached.promise) {\n    const opts = {\n      bufferCommands: false,\n      serverSelectionTimeoutMS: 30000,\n      socketTimeoutMS: 75000,\n      connectTimeoutMS: 30000,\n      maxPoolSize: 10,\n      minPoolSize: 1,\n      retryWrites: true,\n      retryReads: true,\n      // Disable TLS validation to fix Node.js 22 SSL error\n      tls: true,\n      tlsAllowInvalidCertificates: true,\n      tlsAllowInvalidHostnames: true,\n    };\n\n    cached.promise = mongoose.connect(MONGODB_URI, opts).then((mongoose) => {\n      console.log('✅ MongoDB connected successfully');\n      return mongoose;\n    }).catch((err) => {\n      console.error('❌ MongoDB connection error:', err.message);\n      cached.promise = null;\n      throw err;\n    });\n  }\n\n  try {\n    cached.conn = await cached.promise;\n  } catch (e) {\n    cached.promise = null;\n    console.error('❌ MongoDB connection error:', e);\n    throw e;\n  }\n\n  return cached.conn;\n}\n\nexport default connectDB;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAE3C,IAAI,CAAC,aAAa;IAChB,MAAM,IAAI,MACR;AAEJ;AAgBA,IAAI,SAAwB,OAAO,QAAQ,IAAI;IAAE,MAAM;IAAM,SAAS;AAAK;AAE3E,IAAI,CAAC,OAAO,QAAQ,EAAE;IACpB,OAAO,QAAQ,GAAG;AACpB;AAEA,eAAe;IACb,IAAI,OAAO,IAAI,EAAE;QACf,OAAO,OAAO,IAAI;IACpB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YACX,gBAAgB;YAChB,0BAA0B;YAC1B,iBAAiB;YACjB,kBAAkB;YAClB,aAAa;YACb,aAAa;YACb,aAAa;YACb,YAAY;YACZ,qDAAqD;YACrD,KAAK;YACL,6BAA6B;YAC7B,0BAA0B;QAC5B;QAEA,OAAO,OAAO,GAAG,oHAAQ,CAAC,OAAO,CAAC,aAAa,MAAM,IAAI,CAAC,CAAC;YACzD,QAAQ,GAAG,CAAC;YACZ,OAAO;QACT,GAAG,KAAK,CAAC,CAAC;YACR,QAAQ,KAAK,CAAC,+BAA+B,IAAI,OAAO;YACxD,OAAO,OAAO,GAAG;YACjB,MAAM;QACR;IACF;IAEA,IAAI;QACF,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IACpC,EAAE,OAAO,GAAG;QACV,OAAO,OAAO,GAAG;QACjB,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,MAAM;IACR;IAEA,OAAO,OAAO,IAAI;AACpB;uCAEe"}},
    {"offset": {"line": 471, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/app/api/school-registration/route.ts"],"sourcesContent":["import School from '@/lib/models/School'\nimport User from '@/lib/models/User'\nimport connectDB from '@/lib/mongodb'\nimport bcrypt from 'bcrypt'\nimport { NextRequest, NextResponse } from 'next/server'\n\nexport async function POST(request: NextRequest) {\n  try {\n    await connectDB()\n\n    const formData = await request.formData()\n\n    // Extract school information\n    const schoolName = formData.get('schoolName') as string\n    const schoolCode = formData.get('schoolCode') as string\n    const schoolType = formData.get('schoolType') as string\n    const board = formData.get('board') as string\n    const medium = formData.get('medium') as string\n    const logo = formData.get('logo') as File | null\n\n    // Extract address\n    const addressLine1 = formData.get('addressLine1') as string\n    const addressLine2 = formData.get('addressLine2') as string\n    const district = formData.get('district') as string\n    const state = formData.get('state') as string\n    const pincode = formData.get('pincode') as string\n\n    // Extract admin details\n    const adminName = formData.get('adminName') as string\n    const adminEmail = formData.get('adminEmail') as string\n    const adminMobile = formData.get('adminMobile') as string\n    const designation = formData.get('designation') as string\n    const password = formData.get('password') as string\n\n    // Validate required fields\n    if (!schoolName || !schoolCode || !addressLine1 || !district || !state || !pincode ||\n        !adminName || !adminEmail || !adminMobile || !password) {\n      return NextResponse.json(\n        { success: false, error: 'Missing required fields' },\n        { status: 400 }\n      )\n    }\n\n    // Check if school code already exists\n    const existingSchool = await School.findOne({ code: schoolCode.toUpperCase() })\n    if (existingSchool) {\n      return NextResponse.json(\n        { success: false, error: 'School code already exists. Please use a different code.' },\n        { status: 400 }\n      )\n    }\n\n    // Check if school email already exists\n    const existingSchoolEmail = await School.findOne({ email: adminEmail.toLowerCase() })\n    if (existingSchoolEmail) {\n      return NextResponse.json(\n        { success: false, error: 'This email is already registered with another school.' },\n        { status: 400 }\n      )\n    }\n\n    // Check if admin email already exists as a user\n    const existingUser = await User.findOne({ email: adminEmail.toLowerCase() })\n    if (existingUser) {\n      return NextResponse.json(\n        { success: false, error: 'This email is already registered. Please use a different email.' },\n        { status: 400 }\n      )\n    }\n\n    // Handle logo upload (if provided)\n    let logoUrl = ''\n    if (logo && logo.size > 0) {\n      // In production, you would upload to cloud storage (AWS S3, Cloudinary, etc.)\n      // For now, we'll just store the filename\n      logoUrl = `/uploads/logos/${schoolCode.toLowerCase()}-${Date.now()}.${logo.name.split('.').pop()}`\n      \n      // TODO: Implement actual file upload logic here\n      // const uploadResult = await uploadToCloudStorage(logo)\n      // logoUrl = uploadResult.url\n    }\n\n    // Create school\n    const school = await School.create({\n      name: schoolName,\n      code: schoolCode.toUpperCase(),\n      email: adminEmail.toLowerCase(),\n      phone: adminMobile,\n      address: {\n        street: addressLine2 ? `${addressLine1}, ${addressLine2}` : addressLine1,\n        city: district,\n        state: state,\n        country: 'India',\n        zipCode: pincode\n      },\n      type: getSchoolTypeEnum(schoolType),\n      board: board,\n      logo: logoUrl,\n      isActive: false, // Set to false until admin approves\n      subscription: {\n        plan: 'free',\n        startDate: new Date(),\n        maxStudents: 100,\n        maxTeachers: 10\n      },\n      stats: {\n        totalStudents: 0,\n        totalTeachers: 0,\n        totalCourses: 0\n      },\n      principal: {\n        name: adminName,\n        email: adminEmail.toLowerCase(),\n        phone: adminMobile\n      }\n    })\n\n    // Create principal user account\n    const hashedPassword = await bcrypt.hash(password, 10)\n    const adminUser = await User.create({\n      name: adminName,\n      email: adminEmail.toLowerCase(),\n      password: hashedPassword,\n      role: 'principal',\n      phone: adminMobile,\n      schoolId: school._id,\n      bio: `${designation} at ${schoolName}`\n    })\n\n    // Send confirmation email (TODO: Implement email service)\n    // await sendConfirmationEmail(adminEmail, schoolName, schoolCode)\n\n    return NextResponse.json({\n      success: true,\n      message: 'School registered successfully. Awaiting admin approval.',\n      data: {\n        schoolId: school._id,\n        schoolName: school.name,\n        schoolCode: school.code,\n        adminEmail: adminUser.email\n      }\n    }, { status: 201 })\n\n  } catch (error: any) {\n    console.error('School registration error:', error)\n    return NextResponse.json(\n      { \n        success: false, \n        error: 'Registration failed. Please try again.',\n        message: error.message \n      },\n      { status: 500 }\n    )\n  }\n}\n\n// Helper function to map form values to schema enum\nfunction getSchoolTypeEnum(type: string): 'primary' | 'secondary' | 'higher-secondary' | 'university' | 'institute' {\n  const typeMap: Record<string, any> = {\n    'government': 'secondary',\n    'private': 'secondary',\n    'aided': 'secondary',\n    'international': 'institute'\n  }\n  \n  return typeMap[type] || 'secondary'\n}\n"],"names":[],"mappings":"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"}}]
}