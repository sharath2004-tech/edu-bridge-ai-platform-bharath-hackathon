{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/lib/auth.ts"],"sourcesContent":["import { cookies } from 'next/headers';\n\nexport type Session = { id: string; role: 'student'|'teacher'|'admin'; name: string; email: string }\n\nexport async function getSession(): Promise<Session | null> {\n  const cookieStore = await cookies()\n  const c = cookieStore.get('edubridge_session')?.value\n  if (!c) return null\n  try {\n    return JSON.parse(c)\n  } catch {\n    return null\n  }\n}\n\nexport async function requireRole(role: Session['role']): Promise<Session | null> {\n  const s = await getSession()\n  if (!s || s.role !== role) {\n    return null\n  }\n  return s\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAIO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,2QAAO;IACjC,MAAM,IAAI,YAAY,GAAG,CAAC,sBAAsB;IAChD,IAAI,CAAC,GAAG,OAAO;IACf,IAAI;QACF,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe,YAAY,IAAqB;IACrD,MAAM,IAAI,MAAM;IAChB,IAAI,CAAC,KAAK,EAAE,IAAI,KAAK,MAAM;QACzB,OAAO;IACT;IACA,OAAO;AACT"}},
    {"offset": {"line": 75, "column": 0}, "map": {"version":3,"sources":["file:///E:/projects/edu-bridge-ai-platform/app/api/teacher/ai/question-paper/route.ts"],"sourcesContent":["import { getSession } from '@/lib/auth'\nimport { NextRequest, NextResponse } from 'next/server'\n\nconst COHERE_API_KEY = process.env.COHERE_API_KEY\n\nexport async function POST(request: NextRequest) {\n  try {\n    const session = await getSession()\n    if (!session || session.role !== 'teacher') {\n      return NextResponse.json({ success: false, error: 'Unauthorized' }, { status: 401 })\n    }\n\n    const { subject, topic, difficulty, numQuestions, questionTypes, duration } = await request.json()\n\n    const prompt = `Generate a comprehensive question paper for ${subject} on the topic \"${topic}\".\n\nRequirements:\n- Difficulty: ${difficulty}\n- Number of questions: ${numQuestions}\n- Question types: ${questionTypes.join(', ')}\n- Duration: ${duration} minutes\n\nGenerate questions in the following format (as JSON):\n{\n  \"questions\": [\n    {\n      \"type\": \"mcq|short|long|truefalse\",\n      \"question\": \"question text\",\n      \"options\": [\"A\", \"B\", \"C\", \"D\"] (for MCQ only),\n      \"marks\": number,\n      \"answer\": \"correct answer\" (for answer key)\n    }\n  ],\n  \"totalMarks\": total_marks_number\n}\n\nMake questions practical, application-based, and aligned with Bloom's taxonomy for ${difficulty} level.`\n\n    const response = await fetch('https://api.cohere.ai/v1/chat', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${COHERE_API_KEY}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        model: 'command-r-plus-08-2024',\n        message: prompt,\n        temperature: 0.7,\n        max_tokens: 2000\n      })\n    })\n\n    const data = await response.json()\n    \n    let paper\n    try {\n      const jsonMatch = data.text.match(/\\{[\\s\\S]*\\}/)\n      if (jsonMatch) {\n        paper = JSON.parse(jsonMatch[0])\n      } else {\n        // Fallback if JSON parsing fails\n        paper = {\n          questions: generateFallbackQuestions(numQuestions, questionTypes),\n          totalMarks: numQuestions * 5\n        }\n      }\n    } catch {\n      paper = {\n        questions: generateFallbackQuestions(numQuestions, questionTypes),\n        totalMarks: numQuestions * 5\n      }\n    }\n\n    return NextResponse.json({ success: true, paper }, { status: 200 })\n  } catch (error: any) {\n    console.error('Error generating question paper:', error)\n    return NextResponse.json({ success: false, error: error.message }, { status: 500 })\n  }\n}\n\nfunction generateFallbackQuestions(num: number, types: string[]) {\n  const questions = []\n  for (let i = 0; i < num; i++) {\n    const type = types[i % types.length]\n    questions.push({\n      type,\n      question: `Question ${i + 1} - ${type === 'mcq' ? 'Multiple Choice' : type === 'short' ? 'Short Answer' : 'Long Answer'}`,\n      options: type === 'mcq' ? ['Option A', 'Option B', 'Option C', 'Option D'] : undefined,\n      marks: type === 'long' ? 10 : type === 'short' ? 5 : 2,\n      answer: type === 'mcq' ? 'A' : 'Answer text'\n    })\n  }\n  return questions\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc;AAE1C,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,2HAAU;QAChC,IAAI,CAAC,WAAW,QAAQ,IAAI,KAAK,WAAW;YAC1C,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACpF;QAEA,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,UAAU,EAAE,YAAY,EAAE,aAAa,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEhG,MAAM,SAAS,CAAC,4CAA4C,EAAE,QAAQ,eAAe,EAAE,MAAM;;;cAGnF,EAAE,WAAW;uBACJ,EAAE,aAAa;kBACpB,EAAE,cAAc,IAAI,CAAC,MAAM;YACjC,EAAE,SAAS;;;;;;;;;;;;;;;;mFAgB4D,EAAE,WAAW,OAAO,CAAC;QAEpG,MAAM,WAAW,MAAM,MAAM,iCAAiC;YAC5D,QAAQ;YACR,SAAS;gBACP,iBAAiB,CAAC,OAAO,EAAE,gBAAgB;gBAC3C,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB,OAAO;gBACP,SAAS;gBACT,aAAa;gBACb,YAAY;YACd;QACF;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,IAAI;QACJ,IAAI;YACF,MAAM,YAAY,KAAK,IAAI,CAAC,KAAK,CAAC;YAClC,IAAI,WAAW;gBACb,QAAQ,KAAK,KAAK,CAAC,SAAS,CAAC,EAAE;YACjC,OAAO;gBACL,iCAAiC;gBACjC,QAAQ;oBACN,WAAW,0BAA0B,cAAc;oBACnD,YAAY,eAAe;gBAC7B;YACF;QACF,EAAE,OAAM;YACN,QAAQ;gBACN,WAAW,0BAA0B,cAAc;gBACnD,YAAY,eAAe;YAC7B;QACF;QAEA,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM;QAAM,GAAG;YAAE,QAAQ;QAAI;IACnE,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,oCAAoC;QAClD,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnF;AACF;AAEA,SAAS,0BAA0B,GAAW,EAAE,KAAe;IAC7D,MAAM,YAAY,EAAE;IACpB,IAAK,IAAI,IAAI,GAAG,IAAI,KAAK,IAAK;QAC5B,MAAM,OAAO,KAAK,CAAC,IAAI,MAAM,MAAM,CAAC;QACpC,UAAU,IAAI,CAAC;YACb;YACA,UAAU,CAAC,SAAS,EAAE,IAAI,EAAE,GAAG,EAAE,SAAS,QAAQ,oBAAoB,SAAS,UAAU,iBAAiB,eAAe;YACzH,SAAS,SAAS,QAAQ;gBAAC;gBAAY;gBAAY;gBAAY;aAAW,GAAG;YAC7E,OAAO,SAAS,SAAS,KAAK,SAAS,UAAU,IAAI;YACrD,QAAQ,SAAS,QAAQ,MAAM;QACjC;IACF;IACA,OAAO;AACT"}}]
}